<!doctype html>
<html>


<head>
  <title>Dashboard
  </title>
  <style>
    #container {
      display: flex;
      flex-flow: row wrap;
      justify-content: space-evenly;
      align-items: flex-start;
      align-content: space-around;
    }
    #container2 {
      display: flex;
      justify-content: right;
      align-items: right;
      height: 30vh;
    }
    table,
    th,
    td {
      border: 1px solid black;
    }

    /* #status {
      background-color: #3CBC8D;
    } */

    /* input[type=text] {
      /* width: 100%; */
    /* padding: 12px 20px; */
    /* margin: 8px 0;
      box-sizing: border-box;
      border: none;
      background-color: #3CBC8D;
      color: rgb(239, 0, 0);
    }

    input {
      width: auto;
    } */
  </style>




<body>
  <div id = "container2">
  <!-- <p> <strong>THIS IS TO BE USED BY AUTHORIZED STAFF ONLY</strong>.</p>
  {% for message in get_flashed_messages() %}
  <div class="alert">{{ message }}</div> -->
  {% endfor %}
  <div>
    <h2>Update Buttons</h2>
    <form method="post">
      <input type="hidden" name="label" value="update-all-devices">
      <button type="submit" name="update-all-devices">Update All Devices</button>
    </form>
    <br>
    <form method="post">
      <input type="hidden" name="label" value="update scanners from sheet">
      <button type="submit" name="update-from-sheet">Update from Sheet</button>
    </form>
  </div>
</div>

  <div id="container">
  <h2>Device Control</h2>
  
  <table>
    <tr>
      <!-- TODO: make location, alarm delay -->
      <th>Device</th>
      <th>Status</th>
      <th>Location</th>
      <th>Alarm ON</th>
      <th>Alarm Delay</th>
      <th>Alarm Status</th>
      <th>Last Checked In</th>
      <th>Update</th>



    </tr>
    <!-- wrap this tr in a for loop: -->
    {% for device in devices %}
    <tr>
      <td>{{ device.name }}</td>
      <!-- make the device location editable -->
    </td>
    <td style="background-color: {{ device.status_color }};">
      {{ device.status }}
    </td>
      <td>
        <form method="post">
          <input type="hidden" name="label" value="update-location-{{ device.id }}">
          <input type="text" name="location" value="{{ device.location }}">
        </form>
     
      <td style="background-color: {{ device.alarm_power_color }};">
        <!-- <label for="alarm_power">Alarm Power: </label> -->
        <select name="alarm_power" id="alarm_power" style="border: 0; background: transparent;">
          <option disabled selected hidden value="">{{ device.alarm_power }}</option> <!-- this is the default value -->
          {% for option in device.alarm_enable_names %}
          <option value="{{ option }}">{{ option }}</option>
          {% endfor %}
        </select>
        <!-- {{ device.alarm_power }} -->
      </td>
      <td>
        <form method="post">
          <input type="hidden" name="label" value="update-delay-{{ device.id }}">
          <input type="text" name="delay" value="{{ device.alarm_delay_min }}" style="max-width: 10;">
        </form>
      </td>
      <td style="background-color: {{ device.alarm_color }};">
        {{ device.alarm_status }}
      </td>
      

      <td>{{device.last_checked_in}}</td>
      <td>
        <form method="post">
        <form method="post">
          <input type="hidden" name="label" value="update-device">
          <input type="hidden" name="device_id" value="{{ device.id }}">
          <input type="hidden" name="location" value="{{ device.location }}">
          <input type="hidden" name="alarm_power" value="{{ device.alarm_power }}">
          <input type="hidden" name="delay" value="{{ device.alarm_delay_min }}">
          <button type="submit" name="update-device-{{ device.id }}">Update</button>
        </form>
      </td>
    </tr>
    {% endfor %}
    <!-- for loop ends here -->
    </table>
  </div>



  <h2>Tools</h2>
  <!-- create buttons to link to different sites -->
  <div>
    <a href="student">
      <button>Setup Student Card</button>
    </a>
    <br>
    <br>
    <a href="staff">
      <button>Setup Staff Card</button>
    </a>
    <br>
    <br>
    <a href="log">
      <button>Log Files</button>
    </a>
  </div>
</body>
</html>
